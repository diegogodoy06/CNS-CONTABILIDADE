# Plataforma de GestÃ£o ContÃ¡bil Digital

## Documento de Requisitos - VisÃ£o Geral

### VersÃ£o 2.0 | Dezembro 2024

---

## ğŸ“‹ SumÃ¡rio

1. [VisÃ£o Geral do Produto](#1-visÃ£o-geral-do-produto)
2. [Arquitetura do Sistema](#2-arquitetura-do-sistema)
3. [Estrutura de Portais](#3-estrutura-de-portais)
4. [Requisitos NÃ£o Funcionais](#4-requisitos-nÃ£o-funcionais)
5. [Documentos Relacionados](#5-documentos-relacionados)

---

## 1. VisÃ£o Geral do Produto

### 1.1 PropÃ³sito

A **Plataforma de GestÃ£o ContÃ¡bil Digital** Ã© uma soluÃ§Ã£o SaaS completa para escritÃ³rios de contabilidade e seus clientes, composta por dois portais distintos:

| Portal | DescriÃ§Ã£o | PÃºblico |
|--------|-----------|---------|
| **Portal do Cliente** | Autoatendimento para empresas | EmpresÃ¡rios, sÃ³cios, funcionÃ¡rios |
| **Portal Administrativo** | GestÃ£o do escritÃ³rio | Contadores, assistentes |

### 1.2 Modelo de NegÃ³cio

- **PÃºblico-alvo**: EscritÃ³rios de contabilidade com foco em pequenas empresas
- **Modelo**: Plataforma white-label (cada escritÃ³rio com sua marca)
- **MonetizaÃ§Ã£o**: Assinatura mensal por empresa cliente
- **Diferencial**: SimplificaÃ§Ã£o radical + autonomia do cliente

### 1.3 PrincÃ­pios do Design

| PrincÃ­pio | DescriÃ§Ã£o |
|-----------|-----------|
| ğŸ¯ **Simplicidade** | MÃ¡ximo 3 cliques para aÃ§Ãµes principais |
| ğŸ¤– **Autonomia** | Cliente realiza 80% das operaÃ§Ãµes sozinho |
| ğŸ“Š **TransparÃªncia** | InformaÃ§Ãµes fiscais sempre claras |
| â±ï¸ **Disponibilidade** | 99.5% de uptime garantido |
| ğŸ”’ **SeguranÃ§a** | Conformidade LGPD e CFC |

---

## 2. Arquitetura do Sistema

### 2.1 Stack TecnolÃ³gica

#### Frontend (Ambos os Portais)
| Tecnologia | VersÃ£o | PropÃ³sito |
|------------|--------|-----------|
| React | 18+ | Framework UI |
| TypeScript | 5+ | Tipagem |
| Material-UI | 6+ | Componentes |
| Redux Toolkit | - | Estado global |
| React Router | 6+ | Rotas |
| React Hook Form | - | FormulÃ¡rios |
| Recharts | - | GrÃ¡ficos |
| Axios | - | HTTP Client |
| Vite | 6+ | Build tool |

#### Backend
| Tecnologia | VersÃ£o | PropÃ³sito |
|------------|--------|-----------|
| Node.js | 20+ | Runtime |
| Express.js | - | Framework API |
| Prisma | - | ORM |
| JWT | - | AutenticaÃ§Ã£o |
| Bull | - | Filas (Redis) |
| AWS S3 / MinIO | - | Storage |
| SendGrid / SES | - | Email |

#### Banco de Dados
| Tecnologia | PropÃ³sito |
|------------|-----------|
| PostgreSQL 14+ | BD principal |
| Redis 7+ | Cache e filas |

#### Infraestrutura
| Tecnologia | PropÃ³sito |
|------------|-----------|
| Docker | ContainerizaÃ§Ã£o |
| GitHub Actions | CI/CD |
| CloudFlare | CDN |

### 2.2 PadrÃµes de Arquitetura

- **Backend**: Clean Architecture + Repository Pattern
- **Frontend**: Feature-based folder structure
- **API**: RESTful com versionamento (/api/v1/)
- **ComunicaÃ§Ã£o**: Event-driven para processos assÃ­ncronos

### 2.3 Estrutura de Pastas (Frontend)

```
src/
â”œâ”€â”€ features/           # Funcionalidades por domÃ­nio
â”‚   â”œâ”€â”€ auth/          # AutenticaÃ§Ã£o
â”‚   â”œâ”€â”€ dashboard/     # Dashboard
â”‚   â”œâ”€â”€ documents/     # Documentos
â”‚   â”œâ”€â”€ notas/         # Notas Fiscais
â”‚   â”œâ”€â”€ tomadores/     # Tomadores
â”‚   â”œâ”€â”€ guias/         # Guias
â”‚   â”œâ”€â”€ usuarios/      # UsuÃ¡rios
â”‚   â””â”€â”€ ...
â”œâ”€â”€ components/        # Componentes compartilhados
â”‚   â”œâ”€â”€ layout/        # Header, Sidebar, MainLayout
â”‚   â””â”€â”€ shared/        # Componentes reutilizÃ¡veis
â”œâ”€â”€ services/          # APIs e serviÃ§os
â”œâ”€â”€ store/             # Redux (slices, hooks)
â”œâ”€â”€ theme/             # Tema MUI
â””â”€â”€ types/             # TypeScript types
```

---

## 3. Estrutura de Portais

### 3.1 Comparativo de Portais

| Aspecto | Portal Cliente | Portal Administrativo |
|---------|----------------|----------------------|
| **URL** | app.dominio.com.br | admin.dominio.com.br |
| **PÃºblico** | Empresas clientes | EscritÃ³rio contÃ¡bil |
| **Escopo de dados** | Apenas prÃ³pria empresa | Todas as empresas |
| **Login** | Email + Senha | Email corporativo + Senha |
| **2FA** | Opcional | ObrigatÃ³rio (admin/contador) |
| **SessÃ£o** | 4 horas | 8 horas |

### 3.2 Portal do Cliente - Resumo

**MÃ³dulos Principais:**

| MÃ³dulo | Funcionalidades |
|--------|-----------------|
| ğŸ” **AutenticaÃ§Ã£o** | Login, 2FA, Recuperar senha, SeleÃ§Ã£o de empresa |
| ğŸ“Š **Dashboard** | Widgets, MÃ©tricas, Atalhos rÃ¡pidos |
| ğŸ“ **Documentos** | Upload, Categorias, Busca, VisualizaÃ§Ã£o |
| ğŸ“„ **Notas Fiscais** | EmissÃ£o, SimulaÃ§Ã£o, Rascunhos, HistÃ³rico |
| ğŸ‘¥ **Tomadores** | Cadastro, ImportaÃ§Ã£o, HistÃ³rico |
| ğŸ’³ **Guias** | VisualizaÃ§Ã£o, CalendÃ¡rio, Pagamento |
| ğŸ”” **NotificaÃ§Ãµes** | Alertas, ConfiguraÃ§Ãµes |
| ğŸ“ˆ **RelatÃ³rios** | Fiscais, Gerenciais, Analytics |
| âš™ï¸ **ConfiguraÃ§Ãµes** | Empresa, Fiscal, Certificado |
| ğŸ’¬ **ComunicaÃ§Ã£o** | Mensagens, Tickets, FAQ |
| ğŸ‘¤ **UsuÃ¡rios** | GestÃ£o de usuÃ¡rios da empresa |

**Total de Requisitos:** 47

ğŸ“„ **Documento completo:** [Documento_requisitos_CLIENTE.MD](./Documento_requisitos_CLIENTE.MD)

### 3.3 Portal Administrativo - Resumo

**MÃ³dulos Principais:**

| MÃ³dulo | Funcionalidades |
|--------|-----------------|
| ğŸ” **AutenticaÃ§Ã£o** | Login, 2FA obrigatÃ³rio, GestÃ£o de colaboradores |
| ğŸ“Š **Dashboard** | VisÃ£o consolidada, Alertas, KPIs |
| ğŸ¢ **Clientes** | Cadastro, GestÃ£o, Detalhes, AÃ§Ãµes |
| ğŸ‘¥ **UsuÃ¡rios Global** | Todos os usuÃ¡rios de todas as empresas |
| âš ï¸ **Monitoramento** | Alertas, Logs, Auditoria |
| ğŸ“ **Documentos** | Upload em nome do cliente, Guias em lote |
| ğŸ’¬ **ComunicaÃ§Ã£o** | Mensagens, Comunicados em massa, Tickets |
| ğŸ“ˆ **RelatÃ³rios** | Consolidados, Por cliente, Analytics |
| âš™ï¸ **ConfiguraÃ§Ãµes** | EscritÃ³rio, Colaboradores, Planos, Templates |
| ğŸ”Œ **IntegraÃ§Ãµes** | API, Webhooks, Import/Export |

**Total de Requisitos:** 42

ğŸ“„ **Documento completo:** [Documento_requisitos_ADMIN.MD](./Documento_requisitos_ADMIN.MD)

### 3.4 DiferenÃ§as Chave

#### GestÃ£o de UsuÃ¡rios

| Portal | Escopo | Quem gerencia |
|--------|--------|---------------|
| Cliente | Apenas usuÃ¡rios da prÃ³pria empresa | Administrador da empresa |
| Admin | Todos os usuÃ¡rios de todas as empresas | Colaboradores do escritÃ³rio |

#### Documentos e Guias

| Portal | AÃ§Ã£o | Quem faz |
|--------|------|----------|
| Cliente | Upload de documentos prÃ³prios | UsuÃ¡rios da empresa |
| Cliente | VisualizaÃ§Ã£o de guias | Todos os perfis |
| Admin | Upload de guias para qualquer cliente | Colaboradores |
| Admin | Upload em lote (mÃºltiplos clientes) | Colaboradores |

#### ComunicaÃ§Ã£o

| Portal | Tipo | DireÃ§Ã£o |
|--------|------|---------|
| Cliente | Mensagens/Tickets | Cliente â†’ EscritÃ³rio |
| Admin | Resposta a tickets | EscritÃ³rio â†’ Cliente |
| Admin | Comunicados em massa | EscritÃ³rio â†’ MÃºltiplos clientes |

---

## 4. Requisitos NÃ£o Funcionais

### 4.1 SeguranÃ§a

#### RNF-SEC-001: AutenticaÃ§Ã£o e AutorizaÃ§Ã£o
- JWT com RS256 (chaves assimÃ©tricas)
- Refresh token com rotaÃ§Ã£o
- Rate limiting:
  - Login: 5 tentativas / 15 min
  - API geral: 100 req/min por usuÃ¡rio
  - EmissÃ£o NF-e: 20 req/hora por empresa
- CORS restrito
- CSRF protection

#### RNF-SEC-002: Criptografia
- Senhas: bcrypt (cost factor 12)
- Dados sensÃ­veis: AES-256-GCM
- ComunicaÃ§Ã£o: TLS 1.3
- Backup: S3 SSE-KMS

#### RNF-SEC-003: LGPD Compliance
- Consentimento explÃ­cito
- Direito ao esquecimento (anonimizaÃ§Ã£o 5 anos)
- Portabilidade de dados
- DPO designado
- Termos de uso e privacidade

#### RNF-SEC-004: Auditoria
- Log de todas as aÃ§Ãµes crÃ­ticas
- RetenÃ§Ã£o: 5 anos
- Logs imutÃ¡veis
- SIEM para anomalias

#### RNF-SEC-005: Backup
- Backup incremental diÃ¡rio
- Backup completo semanal
- RPO: 24h / RTO: 4h
- Testes trimestrais

### 4.2 Performance

#### RNF-PERF-001: Tempo de Resposta
| OperaÃ§Ã£o | Meta |
|----------|------|
| PÃ¡ginas estÃ¡ticas | < 1s (LCP) |
| Listagens | < 2s |
| EmissÃ£o NF-e | < 5s |
| Busca | < 1.5s |

#### RNF-PERF-002: Escalabilidade
- Horizontal scaling (stateless)
- Load balancing
- Cache multicamadas (Browser, CDN, Redis, PostgreSQL)
- Connection pooling (pgBouncer)

#### RNF-PERF-003: OtimizaÃ§Ãµes
- Lazy loading de componentes
- Code splitting por rota
- Image optimization (WebP)
- PaginaÃ§Ã£o (20-50 itens)
- Compression (gzip/brotli)

#### RNF-PERF-004: Processamento AssÃ­ncrono
- Queue para emails, relatÃ³rios, OCR, NF-e
- Workers escalÃ¡veis
- Dead letter queue

### 4.3 Disponibilidade

#### RNF-DISP-001: Uptime
- SLA: 99.5% (~3.6h/mÃªs de inatividade)
- ManutenÃ§Ãµes programadas: janelas de 2h, horÃ¡rio nÃ£o comercial
- NotificaÃ§Ã£o prÃ©via: 48h

#### RNF-DISP-002: Monitoramento
- Health check: /api/health
- Prometheus metrics
- Alertas PagerDuty/Opsgenie
- Status page pÃºblico

#### RNF-DISP-003: Disaster Recovery
- Multi-region (primary + failover)
- Failover automÃ¡tico < 5 min
- Database replication
- Testes semestrais

### 4.4 Usabilidade

#### RNF-USA-001: Interface
- Design responsivo (mobile-first)
- Breakpoints: 320px, 768px, 1024px, 1440px
- Material Design 3
- Acessibilidade WCAG 2.1 AA

---

## 5. Documentos Relacionados

### Documentos de Requisitos

| Documento | DescriÃ§Ã£o |
|-----------|-----------|
| [Documento_requisitos_CLIENTE.MD](./Documento_requisitos_CLIENTE.MD) | Requisitos detalhados do Portal do Cliente |
| [Documento_requisitos_ADMIN.MD](./Documento_requisitos_ADMIN.MD) | Requisitos detalhados do Portal Administrativo |
| [Roadmap_Implementacao.md](./Roadmap_Implementacao.md) | Roadmap de desenvolvimento |

### Resumo de Requisitos

| Categoria | Cliente | Admin | Total |
|-----------|---------|-------|-------|
| Funcionais | 47 | 42 | **89** |
| NÃ£o Funcionais | - | - | **~20** |
| **TOTAL** | - | - | **~109** |

---

## ğŸ“Š Matriz de Funcionalidades vs Portal

| Funcionalidade | Cliente | Admin |
|----------------|:-------:|:-----:|
| Login email + senha | âœ… | âœ… |
| SeleÃ§Ã£o de mÃºltiplas empresas | âœ… | âŒ |
| 2FA obrigatÃ³rio | âŒ | âœ… (admin) |
| Dashboard prÃ³prio | âœ… | âŒ |
| Dashboard consolidado | âŒ | âœ… |
| Emitir NF-e | âœ… | âœ… |
| Simular NF-e | âœ… | âœ… |
| Upload documentos | âœ… | âœ… |
| Upload guias | âŒ | âœ… |
| Ver guias | âœ… | âœ… |
| Cadastrar tomadores | âœ… | âœ… |
| Ver usuÃ¡rios da empresa | âœ… | âœ… |
| Ver usuÃ¡rios de todas empresas | âŒ | âœ… |
| Convidar usuÃ¡rios | âœ… | âœ… |
| Bloquear usuÃ¡rios | âŒ | âœ… |
| Transferir usuÃ¡rios | âŒ | âœ… |
| Comunicados em massa | âŒ | âœ… |
| Abrir tickets | âœ… | âŒ |
| Responder tickets | âŒ | âœ… |
| Cadastrar clientes | âŒ | âœ… |
| Bloquear clientes | âŒ | âœ… |
| ConfiguraÃ§Ãµes do escritÃ³rio | âŒ | âœ… |
| API/IntegraÃ§Ãµes | âŒ | âœ… |
| Auditoria global | âŒ | âœ… |

---

*Documento atualizado em Dezembro/2024 - v2.0*
